(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{136:function(e,t,n){},137:function(e,t,n){},138:function(e,t,n){},139:function(e,t,n){},140:function(e,t,n){},141:function(e,t,n){},142:function(e,t,n){},143:function(e,t,n){},144:function(e,t,n){},145:function(e,t,n){},146:function(e,t,n){},147:function(e,t,n){},148:function(e,t,n){},149:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n.n(r),a=n(27),s=n.n(a),o=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,151)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),c(e),a(e),s(e)}))},i=n(6),u=n(23),l=n(13),d={projectId:null,title:"",stages:[]};var j={};var b=Object(u.combineReducers)({project:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0,n=Object(l.a)({},e),r=t.payload;switch(t.type){case"project/reorderStages":return n.stages=r,n;case"project/loaded":return n=r;case"project/unloaded":case"user/loggedOut":return d;case"project/updated":return n.projectId===r.projectId&&(n=r),n;case"project/deleted":return r.projectId===n.projectId?d:n;case"stage/reorderTasks":var c=n.stages.findIndex((function(e){return e.stageId===r.stageId}));return n.stages[c]=r,n;case"stage/created":return n.stages=n.stages.concat(r),n;case"stage/updated":var a=n.stages.findIndex((function(e){return e.stageId===r.stageId}));return n.stages[a]=r,n;case"stage/deleted":return n.stages=n.stages.filter((function(e){return e.stageId!==r.stageId})),n;case"task/created":var s=n.stages.find((function(e){return e.stageId===r.stageId}));return s.tasks=s.tasks.concat(r.task),n;case"task/deleted":var o=n.stages.find((function(e){return e.stageId===r.stageId}));return o.tasks=o.tasks.filter((function(e){return e.taskId!==r.taskId})),n;case"task/updated":var i=n.stages.findIndex((function(e){return e.stageId===r.stageId})),u=n.stages[i].tasks.findIndex((function(e){return e.taskId===r.task.taskId}));return n.stages[i].tasks[u]=r.task,n;default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0,n=Object(l.a)({},e),r=t.payload;switch(t.type){case"user/created":return n=r;case"user/loggedIn":return(n=r).flag="LOGGED_IN",n;case"user/loggedOut":return n={flag:"LOGGED_OUT"};case"user/deleted":return n={flag:"DELETED"};case"user/patched":return r.name&&(n.name=r.name),r.email&&(n.email=r.email),n;case"user/reorderProjects":return n.projects=r,n;case"project/created":return n.projects=n.projects.concat({title:r.title,projectId:r.projectId}),n;case"project/updated":var c=n.projects.findIndex((function(e){return e.projectId===r.projectId}));return n.projects[c].title=r.title,n;case"project/deleted":return n.projects=n.projects.filter((function(e){return e.projectId!==r.projectId})),n;default:return e}},token:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return t.token?t.token:"user/loggedOut"===t.type?"":e}}),p=b,f=n(7),h=n(5),O=n(3),x=n(2),g=n.n(x),m=n(4),k="localhost"===window.location.hostname?"http://localhost:5000":"https://taskflow.herokuapp.com";function v(e,t,n){var r={method:e,headers:{Authorization:t,cache:"no-store"}};return n&&(r.headers["Content-Type"]="application/json",r.body=JSON.stringify(n)),r}function y(e){return w.apply(this,arguments)}function w(){return(w=Object(m.a)(g.a.mark((function e(t){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.text){e.next=6;break}return e.next=3,t.text();case 3:n=e.sent,e.next=14;break;case 6:if(!t.json){e.next=13;break}return e.next=9,t.json();case 9:(n=e.sent).error&&(n=t.error),e.next=14;break;case 13:n="Unknown Error. Please try again or contact the site administrator.";case 14:alert("Error: ".concat(n));case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(){return[v,Object(i.c)(),y,"".concat(k,"/api"),Object(i.d)((function(e){return e.token}))]}var N=n(0);function C(e){var t=e.active,n=I(),r=Object(O.a)(n,4),c=r[0],a=r[1],s=r[2],o=r[3];function i(){return(i=Object(m.a)(g.a.mark((function e(t){var n,r,i,u,l;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=document.getElementById("login-user-email"),r=document.getElementById("login-user-password"),i=c("POST",null,{email:n.value,password:r.value}),e.next=6,fetch("".concat(o,"/users/login"),i);case 6:if(!(u=e.sent).ok){e.next=14;break}return e.next=10,u.json();case 10:l=e.sent,a({type:"user/loggedIn",payload:l.user,token:l.token}),e.next=15;break;case 14:s(u);case 15:n.value="",r.value="";case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(N.jsxs)("form",{id:"login-form",className:t?"active":"inactive",onSubmit:function(e){return i.apply(this,arguments)},children:[Object(N.jsx)("input",{id:"login-user-email",type:"text",placeholder:"E-mail"}),Object(N.jsx)("input",{id:"login-user-password",type:"password",placeholder:"Password"}),Object(N.jsx)("button",{type:"submit",className:"btn-confirm",children:"Log In"})]})}function T(e){var t=e.active,n=I(),r=Object(O.a)(n,4),c=r[0],a=r[1],s=r[2],o=r[3];function i(){return(i=Object(m.a)(g.a.mark((function e(){var t,n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c("POST",null,{}),e.next=3,fetch("".concat(o,"/users/temp/"),t);case 3:if(!(n=e.sent).ok){e.next=12;break}return e.next=7,n.json();case 7:r=e.sent,a({type:"user/created",payload:Object(l.a)({flag:"TEMP"},r.user),token:r.token}),alert("A temporary user profile has been created for you. If you wish to save your projects, create an account by clicking on the user tab in the top right corner."),e.next=13;break;case 12:s(n);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(N.jsxs)("div",{id:"preview-initializer",className:t?"active":"inactive",children:[Object(N.jsx)("p",{id:"preview-details",children:"You can try the app without creating an account. Your work will not be saved unless you sign up."}),Object(N.jsx)("button",{className:"btn-confirm",onClick:function(){return i.apply(this,arguments)},children:"Try it out!"})]})}function E(e){var t=e.active,n=I(),r=Object(O.a)(n,5),c=r[0],a=r[1],s=r[2],o=r[3],u=r[4],l=Object(i.d)((function(e){return e.user})),d=Object(h.g)();function j(){return(j=Object(m.a)(g.a.mark((function e(t){var n,r,i,j,b,p,f;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=document.getElementById("new-user-name"),r=document.getElementById("new-user-email"),i=document.getElementById("new-user-password-1"),j=document.getElementById("new-user-password-2"),i.value===j.value){e.next=10;break}return alert("Passwords do not match. Try again."),i.value="",j.value="",e.abrupt("return");case 10:return b="TEMP"===l.flag?c("POST",u,{name:n.value,email:r.value,password:i.value,flag:"IMPORT"}):c("POST",null,{name:n.value,email:r.value,password:i.value}),e.next=13,fetch("".concat(o,"/users"),b);case 13:if(!(p=e.sent).ok){e.next=23;break}return e.next=17,p.json();case 17:f=e.sent,a({type:"user/created",payload:f.user,token:f.token}),alert("User created: \nName: ".concat(f.user.name,"\nEmail: ").concat(f.user.email)),d("/users/".concat(f.user.id,"/projects")),e.next=24;break;case 23:s(p);case 24:n.value="",r.value="",i.value="",j.value="";case 28:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(N.jsxs)("form",{id:"signup-form",className:t?"active":"inactive",onSubmit:function(e){return j.apply(this,arguments)},children:[Object(N.jsx)("input",{id:"new-user-name",className:"form-input",type:"text",placeholder:"User Name"}),Object(N.jsx)("input",{id:"new-user-email",className:"form-input",type:"text",placeholder:"Email Address"}),Object(N.jsx)("input",{id:"new-user-password-1",className:"form-input",type:"password",placeholder:"Password"}),Object(N.jsx)("input",{id:"new-user-password-2",className:"form-input",type:"password",placeholder:"Re-type password"}),Object(N.jsx)("div",{className:"options-block",children:Object(N.jsx)("button",{type:"submit",className:"btn-confirm",children:"Sign Up"})})]})}function S(){var e=Object(h.g)(),t=Object(i.d)((function(e){return e.user}),i.b),n=Object(r.useState)(""),c=Object(O.a)(n,2),a=c[0],s=c[1];return Object(r.useEffect)((function(){t.id&&("TEMP"===t.flag?e("../preview/".concat(t.id,"/projects")):e("../users/".concat(t.id,"/projects")))}),[t,e]),Object(r.useLayoutEffect)((function(){a&&document.getElementById("".concat(a)).scrollIntoView()})),Object(N.jsxs)("main",{className:"home-page",children:[Object(N.jsx)("img",{className:"logo",alt:"Taskflow.tech",src:"/logo.png"}),Object(N.jsx)("h2",{onClick:function(){return s("login-form")},children:"Login"}),Object(N.jsx)(C,{active:"login-form"===a}),Object(N.jsx)("br",{}),Object(N.jsx)("h2",{onClick:function(){return s("signup-form")},children:"Sign Up"}),Object(N.jsx)(E,{active:"signup-form"===a}),Object(N.jsx)("br",{}),Object(N.jsx)("h2",{onClick:function(){return s("preview-initializer")},children:"Preview the app"}),Object(N.jsx)(T,{active:"preview-initializer"===a})]})}function P(){var e=Object(h.g)();return Object(r.useEffect)((function(){setTimeout((function(){e("/")}),1500)}),[e]),Object(N.jsxs)("main",{className:"home-page",children:[Object(N.jsx)("img",{className:"logo",alt:"Taskflow.tech",src:"/logo.png"}),Object(N.jsx)("br",{}),Object(N.jsx)("h2",{children:"You have been logged out and will be redirected."})]})}var A=n(15),D=n(49);function L(){var e=I(),t=Object(O.a)(e,5),n=t[0],r=t[1],c=t[2],a=t[3],s=t[4],o=Object(h.g)(),u=Object(i.d)((function(e){return e.user}));function l(){return d.apply(this,arguments)}function d(){return(d=Object(m.a)(g.a.mark((function e(){var t,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("TEMP"!==u.flag){e.next=3;break}if(window.confirm("Do you want to log out? Your work will not be saved because you haven't created an account.")){e.next=3;break}return e.abrupt("return");case 3:return t=n("POST",s),e.next=6,fetch("".concat(a,"/users/logout"),t);case 6:(i=e.sent).ok?o("/logout"):c(i),setTimeout((function(){r({type:"user/loggedOut"})}),500);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return"TEMP"===u.flag?Object(N.jsxs)("div",{className:"dropdown user-panel",children:[Object(N.jsx)("button",{id:"btn-user-name",children:u.name||"Anonymous User"}),Object(N.jsxs)("div",{className:"dropdown-menu",children:[Object(N.jsx)("button",{onClick:function(){return o("/users/".concat(u.id,"/signup"))},children:"Sign Up"}),Object(N.jsx)("button",{onClick:function(){return o("/users/".concat(u.id,"/projects"))},children:"My Projects"}),Object(N.jsx)("button",{onClick:function(){return l()},id:"btn-logout",children:"Log Out"})]})]}):Object(N.jsxs)("div",{className:"dropdown user-panel",children:[Object(N.jsx)("button",{id:"btn-user-name",children:u.name||"Anonymous User"}),Object(N.jsxs)("div",{className:"dropdown-menu",children:[Object(N.jsx)("button",{onClick:function(){return o("/users/".concat(u.id,"/settings"))},children:"Settings"}),Object(N.jsx)("button",{onClick:function(){return o("/users/".concat(u.id,"/projects"))},children:"My Projects"}),Object(N.jsx)("button",{onClick:function(){return l()},id:"btn-logout",children:"Log Out"})]})]})}function R(){return function(){var e=Object(i.d)((function(e){return e.token})),t=Object(h.g)();Object(r.useEffect)((function(){e||t("../logout")}),[e,t])}(),Object(N.jsxs)("header",{children:[Object(N.jsx)("div",{id:"app-title",children:Object(N.jsx)("img",{className:"logo",alt:"logo",src:"/logo-smol.png"})}),Object(N.jsx)(L,{})]})}var X=n(22);function U(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=Object(A.useDrag)({type:e,item:function(){return{index:t}},collect:function(e){return{isDragging:e.isDragging()}},canDrag:function(e){return!1!==n}}),c=Object(O.a)(r,2),a=c[0].isDragging,s=c[1];return[s,a]}function B(e,t,n,r){var c=Object(A.useDrop)({accept:e,hover:function(e,c){var a;if(r.current){var s=e.index,o=t;if(s!==o){var i=null===(a=r.current)||void 0===a?void 0:a.getBoundingClientRect(),u=(i.right-i.left)/2,l=c.getClientOffset().x-i.left;s<o&&l<u||s>o&&l>u||(n(s,o),e.index=o)}}}});return Object(O.a)(c,2)[1]}var M="projectTab",F="stage",H="task";function G(e){var t=e.index,n=e.title,c=e.projectId,a=e.isActiveProject,s=e.reorderProjects,o=e.loadProject,i=Object(r.useRef)(null),u=U(M,t),l=Object(O.a)(u,2),d=l[0],j=l[1];return d(B(M,t,s,i)(i)),Object(N.jsx)("li",{ref:i,className:a?"active tab":"inactive tab",onClick:function(){return o(c)},style:{opacity:j?0:1},title:"Open ".concat(n," or drag to rearrange"),children:n})}function V(){var e=I(),t=Object(O.a)(e,5),n=t[0],c=t[1],a=t[2],s=t[3],o=t[4],u=Object(h.g)(),l=Object(i.d)((function(e){return e.user.projects}),i.b),d=Object(i.d)((function(e){return e.project.projectId})),j=Object(r.useCallback)(function(){var e=Object(m.a)(g.a.mark((function e(t){var r,i,l,d;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n("GET",o),e.next=3,fetch("".concat(s,"/projects/").concat(t),r);case 3:if(!(i=e.sent).ok){e.next=13;break}return l=i.headers.get("X-Auth-Token"),e.next=8,i.json();case 8:d=e.sent,c({type:"project/loaded",payload:d.project,token:l}),u("../projects/".concat(t)),e.next=14;break;case 13:a(i);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[o,n,c,a,s,u]),b=Object(r.useCallback)(function(){var e=Object(m.a)(g.a.mark((function e(t,r){var i,u,d,j;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=2;break}return e.abrupt("return");case 2:return(i=Object(X.a)(l)).splice(r,0,i.splice(t,1)[0]),c({type:"user/reorderProjects",payload:i}),u=n("PATCH",o,{projects:i.map((function(e){return e.projectId}))}),e.next=8,fetch("".concat(s,"/users/"),u);case 8:(d=e.sent).ok?(j=d.headers.get("X-Auth-Token"))&&c({type:"token/refresh",token:j}):a(d);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[l,o,n,c,a,s]),p=Object(r.useCallback)((function(e,t,n){return Object(N.jsx)(G,{index:e,title:t,projectId:n,isActiveProject:n===d,reorderProjects:b,loadProject:j},n)}),[d,b,j]);return Object(N.jsx)("nav",{id:"navbar",children:Object(N.jsx)("ul",{className:"tab-row",children:null===l||void 0===l?void 0:l.map((function(e,t){return p(t,e.title,e.projectId)}))})})}function Y(e,t,n,r){var c=Object(A.useDrop)({accept:e,hover:function(e,c){var a;if(r.current){var s=e.index,o=t;if(s!==o){var i=null===(a=r.current)||void 0===a?void 0:a.getBoundingClientRect(),u=(i.bottom-i.top)/2,l=c.getClientOffset().Y-i.top;s<o&&l<u||s>o&&l>u||(n(s,o),e.index=o)}}}});return Object(O.a)(c,2)[1]}function z(e){var t=e.stageId,n=e.title,c=e.toggleStageEditor,a=I(),s=Object(O.a)(a,5),o=s[0],i=s[1],u=s[2],l=s[3],d=s[4],j=Object(r.useRef)(null);function b(){return(b=Object(m.a)(g.a.mark((function e(n){var r,a,s,b,p;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),r=j.current.value,a=o("PATCH",d,{title:r}),e.next=5,fetch("".concat(l,"/stages/").concat(t),a);case 5:if(!(s=e.sent).ok){e.next=15;break}return b=s.headers.get("X-Auth-Token"),e.next=10,s.json();case 10:p=e.sent,i({type:"stage/updated",payload:p,token:b}),c(!1),e.next=16;break;case 15:u(s);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useLayoutEffect)((function(){j.current.focus()})),Object(N.jsxs)("form",{className:"stage-name-editor",onSubmit:function(e){return b.apply(this,arguments)},children:[Object(N.jsx)("input",{className:"rename",type:"text",maxLength:30,defaultValue:n,ref:j}),Object(N.jsxs)("div",{className:"options-row",children:[Object(N.jsx)("button",{type:"submit",className:"btn-confirm",children:"Save"}),Object(N.jsx)("button",{className:"btn-cancel",onClick:function(){return c(!1)},children:"Cancel"})]})]})}function J(e){var t=e.taskId,n=e.title,c=e.details,a=e.stageId,s=e.toggleTaskEditor,o=I(),i=Object(O.a)(o,5),u=i[0],l=i[1],d=i[2],j=i[3],b=i[4],p=Object(r.useRef)(null),f=Object(r.useRef)(null);function h(){return(h=Object(m.a)(g.a.mark((function e(n){var r,c,o,i,h,O,x,m,k;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),r=p.current.value,c=f.current.value,t?(o="PATCH",i="".concat(j,"/stages/").concat(a,"/tasks/").concat(t),h="task/updated"):(o="POST",i="".concat(j,"/stages/").concat(a,"/tasks"),h="task/created"),O=u(o,b,{title:r,details:c}),e.next=7,fetch(i,O);case 7:if(!(x=e.sent).ok){e.next=17;break}return m=x.headers.get("X-Auth-Token"),e.next=12,x.json();case 12:k=e.sent,l({type:h,payload:{task:k,stageId:a},token:m}),s(!1),e.next=18;break;case 17:d(x);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useLayoutEffect)((function(){p.current.focus()})),Object(N.jsxs)("form",{className:"task-editor",onSubmit:function(e){return h.apply(this,arguments)},children:[Object(N.jsx)("div",{className:"task-editor-header",children:Object(N.jsx)("input",{className:"task-editor-title",type:"text",maxLength:30,required:!0,defaultValue:n,placeholder:"New Task Title",ref:p})}),Object(N.jsx)("textarea",{className:"task-editor-details",type:"text",maxLength:300,rows:4,defaultValue:c,placeholder:"Details (optional)",ref:f}),Object(N.jsxs)("div",{className:"options-row",children:[Object(N.jsx)("button",{type:"submit",className:"btn-confirm",children:"Save"}),Object(N.jsx)("button",{className:"btn-cancel",onClick:function(e){e.preventDefault(),s(!1)},children:"Cancel"})]})]})}function q(e){var t=e.taskId,n=e.taskIndex,c=e.stageId,a=e.stageIndex,s=e.reorderTasks,o=I(),u=Object(O.a)(o,5),l=u[0],d=u[1],j=u[2],b=u[3],p=u[4],f=Object(r.useRef)(null),h=Object(i.d)((function(e){return e.project.stages[a].tasks[n]})),x=Object(i.d)((function(e){return e.project.stages})),k=Object(r.useState)(!1),v=Object(O.a)(k,2),y=v[0],w=v[1],C=U(H,n),T=Object(O.a)(C,2),E=T[0],S=T[1];function P(){return(P=Object(m.a)(g.a.mark((function e(){var n,r,s,o,i,u,f,O;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x.length-1===a){e.next=18;break}return console.log(x),n=x[a+1].stageId,r=l("POST",p,{title:h.title,details:h.details}),e.next=6,fetch("".concat(b,"/stages/").concat(n,"/tasks"),r);case 6:if(!(s=e.sent).ok){e.next=15;break}return o=s.headers.get("X-Auth-Token"),e.next=11,s.json();case 11:i=e.sent,d({type:"task/created",payload:{task:i,stageId:n},token:o}),e.next=16;break;case 15:j(s);case 16:e.next=20;break;case 18:if(window.confirm("Task ".concat(h.title," is in final stage. Do you want to delete it?"))){e.next=20;break}return e.abrupt("return");case 20:return u=l("DELETE",p),e.next=23,fetch("".concat(b,"/stages/").concat(c,"/tasks/").concat(t),u);case 23:(f=e.sent).ok?(O=f.headers.get("X-Auth-Token"),d({type:"task/deleted",payload:{stageId:c,taskId:t},token:O})):j(f);case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(){return(A=Object(m.a)(g.a.mark((function e(){var n,r,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Delete this task?")){e.next=8;break}return n=l("DELETE",p),e.next=4,fetch("".concat(b,"/stages/").concat(c,"/tasks/").concat(t),n);case 4:(r=e.sent).ok?(a=r.headers.get("X-Auth-Token"),d({type:"task/deleted",payload:{stageId:c,taskId:t},token:a})):j(r),e.next=9;break;case 8:return e.abrupt("return");case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return E(Y(H,n,s,f)(f)),y?Object(N.jsx)(J,{taskId:t,title:h.title,details:h.details,stageId:c,toggleTaskEditor:w}):Object(N.jsxs)("div",{className:"task",ref:f,style:{opacity:S?0:1},children:[Object(N.jsxs)("div",{className:"task-header",children:[Object(N.jsx)("p",{className:"task-title",children:h.title}),Object(N.jsxs)("div",{className:"dropdown task-options",children:[Object(N.jsx)("button",{className:"btn-task-options",children:"\u2630"}),Object(N.jsxs)("div",{className:"dropdown-menu",children:[Object(N.jsx)("button",{className:"btn-mark-task-complete",onClick:function(){return function(){return P.apply(this,arguments)}()},children:"Mark Complete"}),Object(N.jsx)("button",{className:"btn-open-task-editor",onClick:function(){return w(!0)},children:"Edit Task"}),Object(N.jsx)("button",{className:"btn-delete-task",onClick:function(){return function(){return A.apply(this,arguments)}()},children:"Delete Task"})]})]})]}),h.details&&Object(N.jsx)("p",{className:"task-details",children:h.details})]})}function _(e){var t=e.stageId,n=e.stageIndex,c=(e.projectId,e.reorderStages),a=I(),s=Object(O.a)(a,5),o=s[0],u=s[1],l=s[2],d=s[3],j=s[4],b=Object(r.useRef)(null),p=Object(i.d)((function(e){return e.project.stages[n]})),f=Object(i.d)((function(e){return e.project.stages[n].tasks})),h=Object(r.useState)(!1),x=Object(O.a)(h,2),k=x[0],v=x[1],y=Object(r.useState)(!1),w=Object(O.a)(y,2),C=w[0],T=w[1],E=U(F,n),S=Object(O.a)(E,2),P=S[0],A=S[1],D=B(F,n,c,b),L=Y(F,n,c,b);P(D(b)),P(L(b));var R=Object(r.useCallback)(function(){var e=Object(m.a)(g.a.mark((function e(n,r){var c,a,s,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j){e.next=2;break}return e.abrupt("return");case 2:return(c=Object(X.a)(f)).splice(r,0,c.splice(n,1)[0]),u({type:"stage/reorderTasks",payload:{stageId:t,tasks:c}}),a=o("PATCH",j,{tasks:c}),e.next=8,fetch("".concat(d,"/stages/").concat(t),a);case 8:(s=e.sent).ok?(i=s.headers.get("X-Auth-Token"))&&u({type:"token/refresh",token:i}):l(s);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[f,j,t,u,d,o,l]);function M(){return(M=Object(m.a)(g.a.mark((function e(){var n,r,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Delete stage ".concat(p.title," ?"))){e.next=8;break}return n=o("DELETE",j),e.next=4,fetch("".concat(d,"/stages/").concat(t),n);case 4:(r=e.sent).ok?(c=r.headers.get("X-Auth-Token"),u({type:"stage/deleted",payload:{stageId:t},token:c})):l(r),e.next=9;break;case 8:return e.abrupt("return");case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var H=f?f.map((function(e,r){return Object(N.jsx)(q,{taskId:e.taskId,taskIndex:r,stageId:t,stageIndex:n,reorderTasks:R},e.taskId)})):Object(N.jsx)("br",{});return Object(N.jsxs)("section",{className:"stage",ref:b,style:{opacity:A?0:1},children:[Object(N.jsxs)("div",{className:"stage-header",children:[Object(N.jsx)("button",{className:"btn-toggle-task-creator",onClick:function(){return v(!0)},title:"Add a new task",children:"\u2795"}),C?Object(N.jsx)(z,{stageId:t,title:p.title,toggleStageEditor:T}):Object(N.jsx)("h3",{className:"stage-title",title:"Click and drag to rearrange stages",children:p.title}),Object(N.jsxs)("div",{className:"dropdown stage-options",children:[Object(N.jsx)("button",{className:"btn-stage-options",children:"\u2630"}),Object(N.jsxs)("div",{className:"dropdown-menu",children:[Object(N.jsx)("button",{onClick:function(){return T(!0)},children:"Rename Stage"}),Object(N.jsx)("button",{onClick:function(){return function(){return M.apply(this,arguments)}()},children:"Delete Stage"})]})]})]}),k&&Object(N.jsx)(J,{taskId:null,title:null,details:null,stageId:t,toggleTaskEditor:v}),H]},t)}function K(e){var t=e.projectId,n=e.toggleStageCreator,c=I(),a=Object(O.a)(c,5),s=a[0],o=a[1],i=a[2],u=a[3],l=a[4],d=Object(r.useRef)(null),j=Object(r.useRef)(null);function b(){return(b=Object(m.a)(g.a.mark((function e(r){var c,a,d,b;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),c=s("POST",l,{title:j.current.value,projectId:t}),e.next=4,fetch("".concat(u,"/stages"),c);case 4:if(!(a=e.sent).ok){e.next=14;break}return d=a.headers.get("X-Auth-Token"),e.next=9,a.json();case 9:b=e.sent,o({type:"stage/created",payload:b,token:d}),n(!1),e.next=15;break;case 14:i(a);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useLayoutEffect)((function(){window.setTimeout((function(){d.current&&d.current.classList.remove("hidden-below")}),1)}),[d]),Object(r.useLayoutEffect)((function(){window.setTimeout((function(){j.current&&j.current.focus()}),450)}),[j]),Object(N.jsx)("section",{className:"stage-creator hidden-below",ref:d,children:Object(N.jsxs)("form",{onSubmit:function(e){return function(e){return b.apply(this,arguments)}(e)},children:[Object(N.jsx)("h3",{children:"Create Stage:"}),Object(N.jsx)("input",{type:"text",maxLength:26,required:!0,ref:j}),Object(N.jsx)("button",{className:"btn-confirm",type:"submit",children:"Save"}),Object(N.jsx)("button",{className:"btn-toggle-stage-creator btn-cancel",onClick:function(e){e.preventDefault(),n(!1)},children:"Cancel"})]})})}function Q(e){var t=e.isStageCreatorOpen,n=e.toggleStageCreator,c=I(),a=Object(O.a)(c,5),s=a[0],o=a[1],u=a[2],l=a[3],d=a[4],j=Object(i.d)((function(e){return e.project.projectId})),b=Object(i.d)((function(e){return e.project.stages}),i.b);Object(r.useEffect)((function(){0===b.length?n(!0):n(!1)}),[j,b.length,n]);var p=Object(r.useCallback)(function(){var e=Object(m.a)(g.a.mark((function e(t,n){var r,c,a,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d){e.next=2;break}return e.abrupt("return");case 2:return(r=Object(X.a)(b)).splice(n,0,r.splice(t,1)[0]),o({type:"project/reorderStages",payload:r}),c=s("PATCH",d,{stages:r.map((function(e){return e.stageId}))}),e.next=8,fetch("".concat(l,"/projects/").concat(j),c);case 8:(a=e.sent).ok?(i=a.headers.get("X-Auth-Token"))&&o({type:"token/refresh",token:i}):u(a);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[b,d,j,s,o,u,l]),f=null===b||void 0===b?void 0:b.map((function(e,t){return Object(N.jsx)(_,{stageId:e.stageId,stageIndex:t,projectId:j,reorderStages:p},e.stageId)}));return Object(N.jsxs)("main",{id:"project-board",children:[f,t&&Object(N.jsx)(K,{projectId:j,toggleStageCreator:n})]})}function W(){var e=Object(r.useState)(!1),t=Object(O.a)(e,2),n=t[0],c=t[1];return Object(N.jsxs)(A.DndProvider,{backend:D.HTML5Backend,children:[Object(N.jsx)(R,{}),Object(N.jsx)(V,{}),Object(N.jsx)(Q,{isStageCreatorOpen:n,toggleStageCreator:c}),Object(N.jsx)("button",{id:"btn-open-stage-creator",onClick:function(){return c(!0)},children:"\u2795 Add Stage"})]})}function Z(){var e=Object(i.d)((function(e){return e.user})),t={borderLeft:"1px solid black",borderTop:"1px solid black",borderRight:"1px solid black",color:"#000000"},n={color:"#444444"},r="TEMP"===e.flag?Object(N.jsx)(f.b,{to:"signup",className:"tab",style:function(e){return e.isActive?t:n},children:"Sign Up"}):Object(N.jsx)(f.b,{to:"settings",className:"tab",style:function(e){return e.isActive?t:n},children:"User Settings"});return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(R,{}),Object(N.jsxs)("nav",{id:"user-tabs",className:"tab-row",children:[Object(N.jsx)(f.b,{className:"tab",to:"projects",style:function(e){return e.isActive?t:n},children:"My Projects"}),r]}),Object(N.jsxs)("main",{className:"user-page",children:[Object(N.jsx)("br",{}),Object(N.jsx)(h.a,{})]})]})}function $(){var e=I(),t=Object(O.a)(e,5),n=t[0],c=t[1],a=t[2],s=t[3],o=t[4],i=Object(h.g)(),u=Object(r.useState)(!1),l=Object(O.a)(u,2),d=l[0],j=l[1];function b(){return(b=Object(m.a)(g.a.mark((function e(t){var r,u,l,d;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),r=n("POST",o,{title:"".concat(document.getElementById("new-project-title").value)}),e.next=4,fetch("".concat(s,"/projects/"),r);case 4:if(!(u=e.sent).ok){e.next=14;break}return l=u.headers.get("X-Auth-Token"),e.next=9,u.json();case 9:d=e.sent,c({type:"project/created",payload:d.project,token:l}),i("../project/".concat(d.project.projectId)),e.next=15;break;case 14:a(u);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return d?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("h3",{children:"Start a new project:"}),Object(N.jsxs)("form",{id:"new-project-creator",className:"form-row",onSubmit:function(e){return b.apply(this,arguments)},children:[Object(N.jsx)("input",{id:"new-project-title",className:"form-input",placeholder:"Project Title"}),Object(N.jsxs)("div",{className:"options-row",children:[Object(N.jsx)("button",{className:"btn-confirm",children:"Create Project"}),Object(N.jsx)("button",{className:"btn-cancel",type:"button",onClick:function(){return j(!1)},children:"Cancel"})]})]})]}):Object(N.jsx)("div",{className:"options-block",children:Object(N.jsx)("button",{id:"btn-enable-project-creator",className:"btn-confirm",onClick:function(){return j(!0)},children:"Start New Project"})})}function ee(e){var t=e.projectId,n=e.title,c=e.isEditing,a=e.selectEditor,s=I(),o=Object(O.a)(s,5),i=o[0],u=o[1],l=o[2],d=o[3],j=o[4],b=Object(h.g)(),p=Object(r.useRef)(null);function f(){return(f=Object(m.a)(g.a.mark((function e(){var n,r,c,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i("GET",j),e.next=3,fetch("".concat(d,"/projects/").concat(t),n);case 3:if(!(r=e.sent).ok){e.next=13;break}return c=r.headers.get("X-Auth-Token"),e.next=8,r.json();case 8:a=e.sent,u({type:"project/loaded",payload:a.project,token:c}),b("../../../projects/".concat(t)),e.next=14;break;case 13:l(r);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(){return(x=Object(m.a)(g.a.mark((function e(){var r,c,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you wish to delete ".concat(n,"?"))){e.next=8;break}return r=i("DELETE",j),e.next=4,fetch("".concat(d,"/projects/").concat(t),r);case 4:(c=e.sent).ok?(a=c.headers.get("X-Auth-Token"),u({type:"project/deleted",payload:{projectId:t},token:a})):l(c),e.next=9;break;case 8:return e.abrupt("return");case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(){return(k=Object(m.a)(g.a.mark((function e(){var n,r,c,s,o;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=p.current.value,r=i("PATCH",j,{title:n}),e.next=4,fetch("".concat(d,"/projects/").concat(t),r);case 4:if(!(c=e.sent).ok){e.next=14;break}return s=c.headers.get("X-Auth-Token"),e.next=9,c.json();case 9:o=e.sent,u({type:"project/updated",payload:o.project,token:s}),a(null),e.next=15;break;case 14:l(c);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useLayoutEffect)((function(){c&&p.current.focus()})),c?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("input",{className:"project-title",defaultValue:n,ref:p}),Object(N.jsx)("button",{className:"btn-delete-project",onClick:function(){return function(){return x.apply(this,arguments)}(t)},children:"Delete"}),Object(N.jsx)("button",{className:"btn-confirm",onClick:function(){return function(){return k.apply(this,arguments)}(t)},children:"Save"}),Object(N.jsx)("button",{className:"btn-cancel",onClick:function(){return a(null)},children:"Cancel"})]}):Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("div",{className:"project-title",children:n}),Object(N.jsx)("button",{className:"btn-load-project",onClick:function(){return function(){return f.apply(this,arguments)}(t)},children:"Load"}),Object(N.jsx)("div",{className:"dropdown options",children:Object(N.jsx)("button",{className:"btn-options",onClick:function(){return a(t)},children:"Options"})})]})}function te(){var e=Object(i.d)((function(e){return e.user})),t=Object(r.useState)(null),n=Object(O.a)(t,2),c=n[0],a=n[1],s=e.projects?e.projects.map((function(e){return Object(N.jsx)(ee,{projectId:e.projectId,title:e.title,isEditing:c===e.projectId,selectEditor:a},e.projectId)})):null;return Object(N.jsxs)("div",{id:"projects-menu",children:[e.projects&&Object(N.jsx)("div",{id:"projects-list",children:s}),Object(N.jsx)("br",{}),Object(N.jsx)($,{}),"TEMP"===e.flag&&Object(N.jsx)("div",{className:"options-block",children:Object(N.jsx)("button",{id:"signup-link",children:Object(N.jsx)(f.b,{to:"../signup",id:"signup-link",children:"Sign up to save work"})})})]})}function ne(){var e=I(),t=Object(O.a)(e,5),n=t[0],c=t[1],a=t[2],s=t[3],o=t[4],u=Object(h.g)(),l=Object(i.d)((function(e){return e.user})),d=Object(r.useState)(!1),j=Object(O.a)(d,2),b=j[0],p=j[1],f=Object(r.useState)(l.name),x=Object(O.a)(f,2),k=x[0],v=x[1],y=Object(r.useRef)(null);Object(r.useLayoutEffect)((function(){b&&y.current.focus()}),[b]);var w=Object(r.useState)(!1),C=Object(O.a)(w,2),T=C[0],E=C[1],S=Object(r.useState)(l.email),P=Object(O.a)(S,2),A=P[0],D=P[1],L=Object(r.useRef)(null);Object(r.useLayoutEffect)((function(){T&&L.current.focus()}),[T]);var R=Object(r.useState)(!1),X=Object(O.a)(R,2),U=X[0],B=X[1],M=Object(r.useRef)(null),F=Object(r.useRef)(null),H=Object(r.useRef)(null),G=Object(r.useState)(!1),V=Object(O.a)(G,2),Y=V[0],z=V[1],J=Object(r.useRef)(null);function q(){return(q=Object(m.a)(g.a.mark((function e(t){var r,i,u,l;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),r=n("PATCH",o,{name:k}),e.next=4,fetch("".concat(s,"/users/"),r);case 4:if(!(i=e.sent).ok){e.next=15;break}return u=i.headers.get("X-Auth-Token"),e.next=9,i.json();case 9:l=e.sent,p(!1),c({type:"user/patched",payload:l,token:u}),alert("Username successfully changed"),e.next=16;break;case 15:a(i);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(){return(_=Object(m.a)(g.a.mark((function e(t){var r,i,u,l;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),r=n("PATCH",o,{email:A}),e.next=4,fetch("".concat(s,"/users/"),r);case 4:if(!(i=e.sent).ok){e.next=15;break}return u=i.headers.get("X-Auth-Token"),e.next=9,i.json();case 9:l=e.sent,E(!1),c({type:"user/patched",payload:l,token:u}),alert("Email address successfully changed"),e.next=16;break;case 15:a(i);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(){return(K=Object(m.a)(g.a.mark((function e(t){var r,i,u,d,j,b;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),r=M.current.value,i=F.current.value,u=H.current.value,i===u){e.next=8;break}alert("New passwords do not match"),e.next=13;break;case 8:return d=n("PATCH",o,{email:l.email,oldPassword:r,newPassword:i}),e.next=11,fetch("".concat(s,"/users"),d);case 11:(j=e.sent).ok?(b=j.headers.get("X-Auth-Token"),B(!1),c({type:"user/patched",payload:{},token:b}),alert("Password successfully changed")):a(j);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Q(){return(Q=Object(m.a)(g.a.mark((function e(){var t,r,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===J.current.value){e.next=8;break}return t=n("DELETE",o),e.next=4,fetch("".concat(s,"/users"),t);case 4:(r=e.sent).ok?(i=r.headers.get("X-AUTH-TOKEN"),c({type:"user/deleted",payload:{},token:i}),alert("User deleted"),u("/")):a(r),e.next=9;break;case 8:return e.abrupt("return");case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(){return(W=Object(m.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:document.getElementById("current-password").value="",document.getElementById("new-password-1").value="",document.getElementById("new-password-2").value="",B(!1);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Z=b?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("input",{className:"input-left",defaultValue:l.name,onChange:function(e){return v(e.target.value)},ref:y}),Object(N.jsx)("button",{className:"btn-confirm",type:"button",onClick:function(e){return q.apply(this,arguments)},children:"Save"}),Object(N.jsx)("button",{className:"btn-cancel",type:"button",onClick:function(){p(!1),v(l.name)},children:"Cancel"})]}):Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("p",{children:l.name}),Object(N.jsx)("button",{className:"btn-edit-field",onClick:function(){return p(!0)},children:"Edit"})]}),$=T?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("input",{className:"input-left",value:A,onChange:function(e){return D(e.target.value)},ref:L}),Object(N.jsx)("button",{className:"btn-confirm",type:"button",onClick:function(e){return _.apply(this,arguments)},children:"Save"}),Object(N.jsx)("button",{className:"btn-cancel",type:"button",onClick:function(){E(!1),D(l.email)},children:"Cancel"})]}):Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("p",{children:l.email}),Object(N.jsx)("button",{className:"btn-edit-field",onClick:function(){return E(!0)},children:"Edit"})]}),ee=U?Object(N.jsxs)("div",{id:"password-input-fields",children:[Object(N.jsxs)("div",{className:"password-subsection",children:[Object(N.jsx)("p",{className:"password-field-label",children:"Current password:"}),Object(N.jsx)("input",{id:"current-password",className:"input-right",ref:M})]}),Object(N.jsxs)("div",{className:"password-subsection",children:[Object(N.jsx)("p",{children:"Enter new password:"}),Object(N.jsx)("input",{id:"new-password-1",className:"input-right",ref:F})]}),Object(N.jsxs)("div",{className:"password-subsection",children:[Object(N.jsx)("p",{children:"Re-enter new password:"}),Object(N.jsx)("input",{id:"new-password-2",className:"input-right",ref:H})]}),Object(N.jsx)("button",{className:"btn-confirm left",onClick:function(e){return K.apply(this,arguments)},children:"Save"}),Object(N.jsx)("button",{className:"btn-cancel right",onClick:function(){return function(){return W.apply(this,arguments)}()},children:"Cancel"})]}):Object(N.jsx)("button",{className:"btn-change-password center",onClick:function(){return B(!0)},children:"Change Password"}),te=Y?Object(N.jsxs)("div",{className:"delete-user-section",children:[Object(N.jsx)("p",{children:"To delete your account, please enter your password:"}),Object(N.jsx)("input",{ref:J}),Object(N.jsx)("button",{id:"btn-confirm-delete-user",className:"btn-delete",onClick:function(){return function(){return Q.apply(this,arguments)}()},children:"Permanently Delete User"}),Object(N.jsx)("button",{id:"btn-cancel-delete-user",className:"btn-cancel",onClick:function(){return z(!1)},children:"Cancel"})]}):Object(N.jsx)("button",{id:"btn-delete-user",className:"btn-delete",onClick:function(){return z(!0)},children:"Delete User"});return Object(N.jsxs)("div",{id:"user-settings-menu",children:[Object(N.jsxs)("div",{id:"user-settings-grid",children:[Object(N.jsx)("h3",{children:"User Name"}),Z,Object(N.jsx)("h3",{children:"Email Address"}),$,Object(N.jsx)("h3",{children:"Password"})]}),ee,Object(N.jsx)("br",{}),te]})}n(136),n(137),n(138),n(139),n(140),n(141),n(142),n(143),n(144),n(145),n(146),n(147),n(148);function re(){return Object(N.jsx)(f.a,{children:Object(N.jsx)(h.d,{children:Object(N.jsxs)(h.b,{path:"/",element:Object(N.jsx)(h.a,{}),children:[Object(N.jsx)(h.b,{index:!0,element:Object(N.jsx)(S,{})}),Object(N.jsx)(h.b,{path:"logout",element:Object(N.jsx)(P,{})}),Object(N.jsxs)(h.b,{path:"users/:userId/",element:Object(N.jsx)(Z,{}),children:[Object(N.jsx)(h.b,{path:"projects",element:Object(N.jsx)(te,{})}),Object(N.jsx)(h.b,{path:"settings",element:Object(N.jsx)(ne,{})})]}),Object(N.jsxs)(h.b,{path:"preview/:userId/",element:Object(N.jsx)(Z,{}),children:[Object(N.jsx)(h.b,{path:"projects",element:Object(N.jsx)(te,{})}),Object(N.jsx)(h.b,{path:"signup",element:Object(N.jsx)(E,{active:"true"})})]}),Object(N.jsx)(h.b,{path:"projects/:projectId",element:Object(N.jsx)(W,{})}),Object(N.jsx)(h.b,{path:"preview/project/projectId",element:Object(N.jsx)(W,{})}),Object(N.jsx)(h.b,{path:"*",element:Object(N.jsx)(S,{})})]})})})}s.a.render(Object(N.jsx)(c.a.StrictMode,{children:Object(N.jsx)(i.a,{store:Object(u.createStore)(p),children:Object(N.jsx)(re,{})})}),document.getElementById("root")),o()}},[[149,1,2]]]);
//# sourceMappingURL=main.eda80b3f.chunk.js.map